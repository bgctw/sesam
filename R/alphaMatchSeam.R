calcMatchAlphaSeam <- function(
        ### calculate optimal enzyme allocation for given optimal biomass ratio and enzyme levels
        E, decPotR, decPotL, respMaint, parms
        , cnOpt = parms$cnB, cnR=parms$cnIR, cnL=parms$cnIL
){
    alpha <- -(-E^2*decPotR*cnOpt*cnL + E^2*decPotR*cnR*cnL*parms$eps - E^2*decPotL*cnOpt*cnR + E^2*decPotL*cnR*cnL*parms$eps - E^2*cnR*cnL*parms$eps*respMaint - E*decPotR*parms$km*cnOpt*cnL + E*decPotR*parms$km*cnR*cnL*parms$eps + E*decPotL*parms$km*cnOpt*cnR - E*decPotL*parms$km*cnR*cnL*parms$eps + sqrt(E^2*decPotR^2*cnOpt^2*cnL^2 - 2*E^2*decPotR^2*cnOpt*cnR*cnL^2*parms$eps + E^2*decPotR^2*cnR^2*cnL^2*parms$eps^2 + 2*E^2*decPotR*decPotL*cnOpt^2*cnR*cnL - 2*E^2*decPotR*decPotL*cnOpt*cnR^2*cnL*parms$eps - 2*E^2*decPotR*decPotL*cnOpt*cnR*cnL^2*parms$eps + 2*E^2*decPotR*decPotL*cnR^2*cnL^2*parms$eps^2 + 2*E^2*decPotR*cnOpt*cnR*cnL^2*parms$eps*respMaint - 2*E^2*decPotR*cnR^2*cnL^2*parms$eps^2*respMaint + E^2*decPotL^2*cnOpt^2*cnR^2 - 2*E^2*decPotL^2*cnOpt*cnR^2*cnL*parms$eps + E^2*decPotL^2*cnR^2*cnL^2*parms$eps^2 + 2*E^2*decPotL*cnOpt*cnR^2*cnL*parms$eps*respMaint - 2*E^2*decPotL*cnR^2*cnL^2*parms$eps^2*respMaint + E^2*cnR^2*cnL^2*parms$eps^2*respMaint^2 + 2*E*decPotR^2*parms$km*cnOpt^2*cnL^2 - 4*E*decPotR^2*parms$km*cnOpt*cnR*cnL^2*parms$eps + 2*E*decPotR^2*parms$km*cnR^2*cnL^2*parms$eps^2 + 4*E*decPotR*decPotL*parms$km*cnOpt^2*cnR*cnL - 4*E*decPotR*decPotL*parms$km*cnOpt*cnR^2*cnL*parms$eps - 4*E*decPotR*decPotL*parms$km*cnOpt*cnR*cnL^2*parms$eps + 4*E*decPotR*decPotL*parms$km*cnR^2*cnL^2*parms$eps^2 + 6*E*decPotR*parms$km*cnOpt*cnR*cnL^2*parms$eps*respMaint - 6*E*decPotR*parms$km*cnR^2*cnL^2*parms$eps^2*respMaint + 2*E*decPotL^2*parms$km*cnOpt^2*cnR^2 - 4*E*decPotL^2*parms$km*cnOpt*cnR^2*cnL*parms$eps + 2*E*decPotL^2*parms$km*cnR^2*cnL^2*parms$eps^2 + 6*E*decPotL*parms$km*cnOpt*cnR^2*cnL*parms$eps*respMaint - 6*E*decPotL*parms$km*cnR^2*cnL^2*parms$eps^2*respMaint + 4*E*parms$km*cnR^2*cnL^2*parms$eps^2*respMaint^2 + decPotR^2*parms$km^2*cnOpt^2*cnL^2 -2*decPotR^2*parms$km^2*cnOpt*cnR*cnL^2*parms$eps + decPotR^2*parms$km^2*cnR^2*cnL^2*parms$eps^2 - 2*decPotR*decPotL*parms$km^2*cnOpt^2*cnR*cnL + 2*decPotR*decPotL*parms$km^2*cnOpt*cnR^2*cnL*parms$eps + 2*decPotR*decPotL*parms$km^2*cnOpt*cnR*cnL^2*parms$eps - 2*decPotR*decPotL*parms$km^2*cnR^2*cnL^2*parms$eps^2 + 4*decPotR*parms$km^2*cnOpt*cnR*cnL^2*parms$eps*respMaint - 4*decPotR*parms$km^2*cnR^2*cnL^2*parms$eps^2*respMaint + decPotL^2*parms$km^2*cnOpt^2*cnR^2- 2*decPotL^2*parms$km^2*cnOpt*cnR^2*cnL*parms$eps + decPotL^2*parms$km^2*cnR^2*cnL^2*parms$eps^2 + 4*decPotL*parms$km^2*cnOpt*cnR^2*cnL*parms$eps*respMaint - 4*decPotL*parms$km^2*cnR^2*cnL^2*parms$eps^2*respMaint + 4*parms$km^2*cnR^2*cnL^2*parms$eps^2*respMaint^2)*abs(E))/(2*E^2*decPotR*cnOpt*cnL - 2*E^2*decPotR*cnR*cnL*parms$eps + 2*E^2*decPotL*cnOpt*cnR - 2*E^2*decPotL*cnR*cnL*parms$eps + 2*E^2*cnR*cnL*parms$eps*respMaint)
    if( alpha < 0 ) alpha <- 0
    if( alpha > 1 ) alpha <- 1
    alpha
}
attr(calcMatchAlphaSeam, "ex") <- function(){
    E=16; decPotR=1000; decPotL=1000; respMaint=0.4; p<-parms<-parms0; cnOpt <- p$cnB; cnR=p$cnIR; cnL=p$cnIL
    alpha <- alpha0 <- calcMatchAlphaSeam( E=E, decPotR=decPotR, decPotL=decPotL, respMaint=respMaint, parms=p, cnOpt=cnOpt, cnR=cnR, cnL=cnL)
    decR <- decPotR*alpha*E/(p$km + alpha*E)
    decL <- decPotL*(1-alpha)*E/(p$km + (1-alpha)*E)
    synC <- p$eps*(decR + decL - respMaint)
    synN <- decR/cnR + decL/cnL
    synC/synN
    
    (alpha <- alphaEnz <- calcMatchAlphaEnz( E=E, decPotR=decPotR, decPotL=decPotL, respMaint=respMaint, parms=p, cnOpt=cnOpt, cnR=cnR, cnL=cnL))
    #alpha <- 0
    decR <- decPotR*alpha*E/(p$km + alpha*E)
    decL <- decPotL*(1-alpha)*E/(p$km + (1-alpha)*E)
    decE <- p$kNB * p$kN * E
    decE/(decR+decL+decE)
    synC <- p$eps*(decR + decL + decE - respMaint)
    synN <- decR/cnR + decL/cnL + decE/p$cnE
    synC/synN
    
}


calcMatchAlphaEnz <- function(
        ### calculate optimal enzyme allocation for given optimal biomass ratio and enzyme levels by taking into account turnover of enzymes 
        E, decPotR, decPotL, respMaint, parms, cnOpt = parms$cnB, cnR=parms$cnIR, cnL=parms$cnIL
){
    ##details<< 
    ## Does not work so far. Do not understand why - numerical error? using the one without enzyme trvr
    alpha <- -(-E^3*cnOpt*cnR*cnL*parms$kN*parms$kNB + E^3*cnR*cnL*parms$cnE*parms$eps*parms$kN*parms$kNB - E^2*cnOpt*cnR*decPotL*parms$cnE - E^2*cnOpt*cnL*decPotR*parms$cnE + E^2*cnR*cnL*decPotR*parms$cnE*parms$eps + E^2*cnR*cnL*decPotL*parms$cnE*parms$eps - E^2*cnR*cnL*parms$cnE*parms$eps*respMaint + E*cnOpt*cnR*decPotL*parms$cnE*parms$km - E*cnOpt*cnL*decPotR*parms$cnE*parms$km +E*cnR*cnL*decPotR*parms$cnE*parms$eps*parms$km - E*cnR*cnL*decPotL*parms$cnE*parms$eps*parms$km + sqrt(E^4*cnOpt^2*cnR^2*cnL^2*parms$kN^2*parms$kNB^2 - 2*E^4*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2+ E^4*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2 + 4*E**3*cnOpt^2*cnR^2*cnL^2*parms$kN^2*parms$kNB^2*parms$km + 2*E^3*cnOpt^2*cnR^2*cnL*decPotL*parms$cnE*parms$kN*parms$kNB + 2*E^3*cnOpt^2*cnR*cnL^2*decPotR*parms$cnE*parms$kN*parms$kNB - 2*E^3*cnOpt*cnR^2*cnL^2*decPotR*parms$cnE*parms$eps*parms$kN*parms$kNB - 2*E^3*cnOpt*cnR^2*cnL^2*decPotL*parms$cnE*parms$eps*parms$kN*parms$kNB - 8*E^3*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2*parms$km + 2*E^3*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN*parms$kNB*respMaint - 2*E^3*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*parms$kN*parms$kNB - 2*E^3*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$kN*parms$kNB + 2*E^3*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB + 2*E^3*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB + 4*E^3*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2*parms$km - 2*E^3*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*respMaint + 4*E^2*cnOpt^2*cnR^2*cnL^2*parms$kN^2*parms$kNB^2*parms$km^2 + 6*E^2*cnOpt^2*cnR^2*cnL*decPotL*parms$cnE*parms$kN*parms$kNB*parms$km + E^2*cnOpt^2*cnR^2*decPotL^2*parms$cnE^2 + 6*E^2*cnOpt^2*cnR*cnL^2*decPotR*parms$cnE*parms$kN*parms$kNB*parms$km+ 2*E^2*cnOpt^2*cnR*cnL*decPotR*decPotL*parms$cnE^2 + E^2*cnOpt^2*cnL**2*decPotR^2*parms$cnE^2 - 6*E^2*cnOpt*cnR^2*cnL^2*decPotR*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km - 6*E^2*cnOpt*cnR^2*cnL^2*decPotL*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km - 8*E^2*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2*parms$km^2 + 8*E^2*cnOpt*cnR^2*cnL**2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km*respMaint - 2*E^2*cnOpt*cnR^2*cnL*decPotR*decPotL*parms$cnE^2*parms$eps - 2*E^2*cnOpt*cnR^2*cnL*decPotL^2*parms$cnE^2*parms$eps - 6*E^2*cnOpt*cnR^2*cnL*decPotL*parms$cnE**2*parms$eps*parms$kN*parms$kNB*parms$km + 2*E^2*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*respMaint - 2*E^2*cnOpt*cnR*cnL^2*decPotR^2*parms$cnE^2*parms$eps - 2*E^2*cnOpt*cnR*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps - 6*E^2*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km + 2*E^2*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*respMaint + E^2*cnR^2*cnL^2*decPotR^2*parms$cnE^2*parms$eps^2 + 2*E^2*cnR^2*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps^2 + 6*E^2*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km - 2*E^2*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*respMaint + E^2*cnR^2*cnL^2*decPotL^2*parms$cnE^2*parms$eps^2 + 6*E^2*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km - 2*E^2*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*respMaint + 4*E^2*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2*parms$km^2 - 8*E^2*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km*respMaint + E^2*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*respMaint^2 + 4*E*cnOpt^2*cnR^2*cnL*decPotL*parms$cnE*parms$kN*parms$kNB*parms$km^2 + 2*E*cnOpt^2*cnR^2*decPotL^2*parms$cnE^2*parms$km + 4*E*cnOpt^2*cnR*cnL^2*decPotR*parms$cnE*parms$kN*parms$kNB*parms$km^2+ 4*E*cnOpt^2*cnR*cnL*decPotR*decPotL*parms$cnE^2*parms$km + 2*E*cnOpt^2*cnL^2*decPotR^2*parms$cnE^2*parms$km - 4*E*cnOpt*cnR^2*cnL^2*decPotR*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2 - 4*E*cnOpt*cnR^2*cnL^2*decPotL*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2 + 8*E*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2*respMaint - 4*E*cnOpt*cnR^2*cnL*decPotR*decPotL*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnR^2*cnL*decPotL^2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km^2 + 6*E*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*parms$km*respMaint - 4*E*cnOpt*cnR*cnL^2*decPotR^2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnR*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km^2 + 6*E*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$km*respMaint + 2*E*cnR^2*cnL^2*decPotR^2*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnR^2*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2 - 6*E*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$km*respMaint + 2*E*cnR^2*cnL^2*decPotL^2*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2 - 6*E*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*parms$km*respMaint - 8*E*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2*respMaint + 4*E*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$km*respMaint^2 + cnOpt^2*cnR^2*decPotL^2*parms$cnE^2*parms$km^2 - 2*cnOpt^2*cnR*cnL*decPotR*decPotL*parms$cnE^2*parms$km^2 + cnOpt^2*cnL^2*decPotR^2*parms$cnE^2*parms$km^2 + 2*cnOpt*cnR^2*cnL*decPotR*decPotL*parms$cnE^2*parms$eps*parms$km^2 - 2*cnOpt*cnR^2*cnL*decPotL^2*parms$cnE^2*parms$eps*parms$km^2 + 4*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*parms$km^2*respMaint - 2*cnOpt*cnR*cnL^2*decPotR^2*parms$cnE^2*parms$eps*parms$km^2 + 2*cnOpt*cnR*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps*parms$km^2 + 4*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$km^2*respMaint + cnR^2*cnL^2*decPotR^2*parms$cnE^2*parms$eps^2*parms$km^2 - 2*cnR^2*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps^2*parms$km^2 - 4*cnR**2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$km^2*respMaint + cnR^2*cnL^2*decPotL^2*parms$cnE^2*parms$eps^2*parms$km^2 - 4*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*parms$km^2*respMaint + 4*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$km^2*respMaint^2)*abs(E))/(2*E^3*cnOpt*cnR*cnL*parms$kN*parms$kNB - 2*E^3*cnR*cnL*parms$cnE*parms$eps*parms$kN*parms$kNB + 2*E**2*cnOpt*cnR*decPotL*parms$cnE + 2*E^2*cnOpt*cnL*decPotR*parms$cnE - 2*E^2*cnR*cnL*decPotR*parms$cnE*parms$eps - 2*E^2*cnR*cnL*decPotL*parms$cnE*parms$eps + 2*E^2*cnR*cnL*parms$cnE*parms$eps*respMaint)
    # second solution in alpha_maint.py:
    #alpha <- (E^3*cnOpt*cnR*cnL*parms$kN*parms$kNB - E^3*cnR*cnL*parms$cnE*parms$eps*parms$kN*parms$kNB + E^2*cnOpt*cnR*decPotL*parms$cnE + E^2*cnOpt*cnL*decPotR*parms$cnE - E^2*cnR*cnL*decPotR*parms$cnE*parms$eps - E^2*cnR*cnL*decPotL*parms$cnE*parms$eps + E^2*cnR*cnL*parms$cnE*parms$eps*respMaint - E*cnOpt*cnR*decPotL*parms$cnE*parms$km + E*cnOpt*cnL*decPotR*parms$cnE*parms$km - E*cnR*cnL*decPotR*parms$cnE*parms$eps*parms$km + E*cnR*cnL*decPotL*parms$cnE*parms$eps*parms$km + sqrt(E^4*cnOpt^2*cnR^2*cnL^2*parms$kN^2*parms$kNB^2 - 2*E^4*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2 +E^4*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2 + 4*E^3*cnOpt^2*cnR^2*cnL^2*parms$kN^2*parms$kNB^2*parms$km + 2*E^3*cnOpt^2*cnR^2*cnL*decPotL*parms$cnE*parms$kN*parms$kNB + 2*E^3*cnOpt^2*cnR*cnL^2*decPotR*parms$cnE*parms$kN*parms$kNB - 2*E^3*cnOpt*cnR^2*cnL^2*decPotR*parms$cnE*parms$eps*parms$kN*parms$kNB - 2*E^3*cnOpt*cnR^2*cnL^2*decPotL*parms$cnE*parms$eps*parms$kN*parms$kNB - 8*E^3*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2*parms$km + 2*E^3*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN*parms$kNB*respMaint - 2*E^3*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*parms$kN*parms$kNB - 2*E^3*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$kN*parms$kNB + 2*E^3*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB + 2*E^3*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB + 4*E^3*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2*parms$km - 2*E^3*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*respMaint + 4*E^2*cnOpt^2*cnR^2*cnL^2*parms$kN^2*parms$kNB^2*parms$km^2 + 6*E^2*cnOpt^2*cnR^2*cnL*decPotL*parms$cnE*parms$kN*parms$kNB*parms$km + E^2*cnOpt^2*cnR^2*decPotL^2*parms$cnE^2+ 6*E^2*cnOpt^2*cnR*cnL^2*decPotR*parms$cnE*parms$kN*parms$kNB*parms$km +2*E^2*cnOpt^2*cnR*cnL*decPotR*decPotL*parms$cnE^2 + E^2*cnOpt^2*cnL^2*decPotR^2*parms$cnE^2 - 6*E^2*cnOpt*cnR^2*cnL^2*decPotR*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km - 6*E^2*cnOpt*cnR^2*cnL^2*decPotL*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km - 8*E^2*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2*parms$km^2 + 8*E^2*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km*respMaint - 2*E^2*cnOpt*cnR^2*cnL*decPotR*decPotL*parms$cnE^2*parms$eps - 2*E^2*cnOpt*cnR^2*cnL*decPotL^2*parms$cnE^2*parms$eps - 6*E^2*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km + 2*E^2*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*respMaint - 2*E^2*cnOpt*cnR*cnL^2*decPotR^2*parms$cnE^2*parms$eps - 2*E^2*cnOpt*cnR*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps - 6*E^2*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km + 2*E^2*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*respMaint + E^2*cnR^2*cnL^2*decPotR^2*parms$cnE^2*parms$eps^2 + 2*E^2*cnR^2*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps^2 + 6*E^2*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km - 2*E^2*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*respMaint + E^2*cnR^2*cnL^2*decPotL^2*parms$cnE^2*parms$eps^2 + 6*E^2*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km - 2*E^2*cnR^2*cnL^2*decPotL*parms$cnE**2*parms$eps^2*respMaint + 4*E^2*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2*parms$km^2 - 8*E^2*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km*respMaint + E^2*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*respMaint^2 + 4*E*cnOpt^2*cnR^2*cnL*decPotL*parms$cnE*parms$kN*parms$kNB*parms$km^2 + 2*E*cnOpt^2*cnR^2*decPotL^2*parms$cnE^2*parms$km+ 4*E*cnOpt^2*cnR*cnL^2*decPotR*parms$cnE*parms$kN*parms$kNB*parms$km^2 +4*E*cnOpt^2*cnR*cnL*decPotR*decPotL*parms$cnE^2*parms$km + 2*E*cnOpt^2*cnL^2*decPotR^2*parms$cnE^2*parms$km - 4*E*cnOpt*cnR^2*cnL^2*decPotR*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2 - 4*E*cnOpt*cnR^2*cnL^2*decPotL*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2 + 8*E*cnOpt*cnR^2*cnL^2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2*respMaint - 4*E*cnOpt*cnR^2*cnL*decPotR*decPotL*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnR^2*cnL*decPotL^2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km^2 + 6*E*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*parms$km*respMaint - 4*E*cnOpt*cnR*cnL^2*decPotR^2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnR*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km^2 + 6*E*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$km*respMaint + 2*E*cnR^2*cnL^2*decPotR^2*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnR^2*cnL^2*decPotR*decPotL*parms$cnE**2*parms$eps^2*parms$km + 4*E*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2 - 6*E*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$km*respMaint + 2*E*cnR^2*cnL^2*decPotL^2*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2 - 6*E*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps**2*parms$km*respMaint - 8*E*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2*respMaint + 4*E*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$km*respMaint^2 + cnOpt^2*cnR^2*decPotL^2*parms$cnE^2*parms$km^2 - 2*cnOpt^2*cnR*cnL*decPotR*decPotL*parms$cnE^2*parms$km^2 + cnOpt^2*cnL^2*decPotR^2*parms$cnE^2*parms$km^2 + 2*cnOpt*cnR^2*cnL*decPotR*decPotL*parms$cnE^2*parms$eps*parms$km^2 - 2*cnOpt*cnR^2*cnL*decPotL^2*parms$cnE**2*parms$eps*parms$km^2 + 4*cnOpt*cnR^2*cnL*decPotL*parms$cnE^2*parms$eps*parms$km^2*respMaint - 2*cnOpt*cnR*cnL^2*decPotR^2*parms$cnE^2*parms$eps*parms$km^2 + 2*cnOpt*cnR*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps*parms$km^2 + 4*cnOpt*cnR*cnL^2*decPotR*parms$cnE^2*parms$eps*parms$km^2*respMaint + cnR^2*cnL^2*decPotR^2*parms$cnE^2*parms$eps^2*parms$km^2 - 2*cnR^2*cnL^2*decPotR*decPotL*parms$cnE^2*parms$eps^2*parms$km^2 - 4*cnR^2*cnL^2*decPotR*parms$cnE^2*parms$eps^2*parms$km^2*respMaint + cnR^2*cnL^2*decPotL^2*parms$cnE^2*parms$eps^2*parms$km^2 - 4*cnR^2*cnL^2*decPotL*parms$cnE^2*parms$eps^2*parms$km^2*respMaint + 4*cnR^2*cnL^2*parms$cnE^2*parms$eps^2*parms$km^2*respMaint^2)*abs(E))/(2*E^3*cnOpt*cnR*cnL*parms$kN*parms$kNB - 2*E^3*cnR*cnL*parms$cnE*parms$eps*parms$kN*parms$kNB + 2*E^2*cnOpt*cnR*decPotL*parms$cnE + 2*E^2*cnOpt*cnL*decPotR*parms$cnE - 2*E^2*cnR*cnL*decPotR*parms$cnE*parms$eps - 2*E^2*cnR*cnL*decPotL*parms$cnE*parms$eps + 2*E^2*cnR*cnL*parms$cnE*parms$eps*respMaint)
    #with( parms,
    #-(-E^3*cnB*cnR*cnL*kN*km + E^3*cnE*cnR*cnL*eps*kN*km - E^2*decPotR*cnB*cnE*cnL + E^2*decPotR*cnE*cnR*cnL*eps - E^2*decPotL*cnB*cnE*cnR + E^2*decPotL*cnE*cnR*cnL*eps - E^2*cnE*cnR*cnL*eps*respMaint - E*decPotR*km*cnB*cnE*cnL + E*decPotR*km*cnE*cnR*cnL*eps + E*decPotL*km*cnB*cnE*cnR - E*decPotL*km*cnE*cnR*cnL*eps + sqrt(E^4*cnB^2*cnR^2*cnL^2*kN^2*km^2 - 2*E^4*cnB*cnE*cnR^2*cnL^2*eps*kN^2*km^2 + E**4*cnE^2*cnR^2*cnL^2*eps^2*kN^2*km^2 + 2*E^3*decPotR*cnB^2*cnE*cnR*cnL^2*kN*kNB - 2*E^3*decPotR*cnB*cnE^2*cnR*cnL^2*eps*kN*km - 2*E^3*decPotR*cnB*cnE*cnR^2*cnL^2*eps*kN*km + 2*E^3*decPotR*cnE^2*cnR^2*cnL^2*eps^2*kN*km + 2*E^3*decPotL*cnB^2*cnE*cnR^2*cnL*kN*km - 2*E^3*decPotL*cnB*cnE^2*cnR^2*cnL*eps*kN*km - 2*E^3*decPotL*cnB*cnE*cnR^2*cnL^2*eps*kN*km + 2*E^3*decPotL*cnE^2*cnR^2*cnL^2*eps^2*kN*km + 4*E^3*km*cnB^2*cnR^2*cnL^2*kN^2*km^2 - 8*E^3*km*cnB*cnE*cnR^2*cnL^2*eps*kN^2*km^2 + 4*E^3*km*cnE^2*cnR^2*cnL^2*eps^2*kN^2*km^2 + 2*E^3*cnB*cnE*cnR^2*cnL^2*eps*kN*km*respMaint - 2*E^3*cnE^2*cnR^2*cnL^2*eps^2*kN*km*respMaint + E^2*decPotR^2*cnB^2*cnE^2*cnL^2 - 2*E^2*decPotR^2*cnB*cnE^2*cnR*cnL^2*eps + E^2*decPotR^2*cnE^2*cnR^2*cnL^2*eps^2 + 2*E^2*decPotR*decPotL*cnB^2*cnE^2*cnR*cnL - 2*E^2*decPotR*decPotL*cnB*cnE^2*cnR^2*cnL*eps - 2*E^2*decPotR*decPotL*cnB*cnE^2*cnR*cnL^2*eps + 2*E^2*decPotR*decPotL*cnE^2*cnR^2*cnL^2*eps^2 + 6*E^2*decPotR*km*cnB^2*cnE*cnR*cnL^2*kN*km - 6*E^2*decPotR*km*cnB*cnE^2*cnR*cnL^2*eps*kN*km - 6*E^2*decPotR*km*cnB*cnE*cnR^2*cnL^2*eps*kN*km + 6*E^2*decPotR*km*cnE^2*cnR^2*cnL^2*eps^2*kN*km + 2*E^2*decPotR*cnB*cnE^2*cnR*cnL^2*eps*respMaint - 2*E^2*decPotR*cnE^2*cnR^2*cnL^2*eps^2*respMaint + E^2*decPotL**2*cnB^2*cnE^2*cnR^2 - 2*E^2*decPotL^2*cnB*cnE^2*cnR^2*cnL*eps + E^2*decPotL^2*cnE^2*cnR^2*cnL^2*eps^2 + 6*E^2*decPotL*km*cnB^2*cnE*cnR^2*cnL*kN*km - 6*E^2*decPotL*km*cnB*cnE^2*cnR^2*cnL*eps*kN*km - 6*E^2*decPotL*km*cnB*cnE*cnR^2*cnL^2*eps*kN*km + 6*E^2*decPotL*km*cnE^2*cnR^2*cnL^2*eps^2*kN*km + 2*E^2*decPotL*cnB*cnE^2*cnR^2*cnL*eps*respMaint - 2*E^2*decPotL*cnE^2*cnR^2*cnL^2*eps^2*respMaint + 4*E^2*km^2*cnB^2*cnR^2*cnL^2*kN^2*km^2 - 8*E^2*km^2*cnB*cnE*cnR^2*cnL^2*eps*kN^2*km^2 + 4*E^2*km^2*cnE^2*cnR^2*cnL^2*eps^2*kN^2*kNB^2 + 8*E^2*km*cnB*cnE*cnR^2*cnL^2*eps*kN*km*respMaint - 8*E^2*km*cnE^2*cnR^2*cnL^2*eps^2*kN*km*respMaint + E^2*cnE^2*cnR^2*cnL^2*eps^2*respMaint^2 + 2*E*decPotR^2*km*cnB^2*cnE^2*cnL^2 - 4*E*decPotR^2*km*cnB*cnE^2*cnR*cnL^2*eps + 2*E*decPotR^2*km*cnE^2*cnR^2*cnL^2*eps^2 + 4*E*decPotR*decPotL*km*cnB^2*cnE^2*cnR*cnL - 4*E*decPotR*decPotL*km*cnB*cnE^2*cnR^2*cnL*eps - 4*E*decPotR*decPotL*km*cnB*cnE^2*cnR*cnL^2*eps + 4*E*decPotR*decPotL*km*cnE^2*cnR^2*cnL^2*eps^2 + 4*E*decPotR*km^2*cnB^2*cnE*cnR*cnL^2*kN*km - 4*E*decPotR*km^2*cnB*cnE^2*cnR*cnL^2*eps*kN*km - 4*E*decPotR*km^2*cnB*cnE*cnR^2*cnL^2*eps*kN*km + 4*E*decPotR*km^2*cnE^2*cnR^2*cnL^2*eps^2*kN*km + 6*E*decPotR*km*cnB*cnE^2*cnR*cnL^2*eps*respMaint - 6*E*decPotR*km*cnE^2*cnR^2*cnL^2*eps^2*respMaint + 2*E*decPotL^2*km*cnB^2*cnE^2*cnR^2 - 4*E*decPotL**2*km*cnB*cnE^2*cnR^2*cnL*eps + 2*E*decPotL^2*km*cnE^2*cnR^2*cnL^2*eps^2 + 4*E*decPotL*km^2*cnB^2*cnE*cnR^2*cnL*kN*km - 4*E*decPotL*km^2*cnB*cnE^2*cnR^2*cnL*eps*kN*km - 4*E*decPotL*km^2*cnB*cnE*cnR^2*cnL^2*eps*kN*km + 4*E*decPotL*km^2*cnE^2*cnR^2*cnL^2*eps^2*kN*km + 6*E*decPotL*km*cnB*cnE^2*cnR^2*cnL*eps*respMaint -6*E*decPotL*km*cnE^2*cnR^2*cnL^2*eps^2*respMaint + 8*E*km^2*cnB*cnE*cnR^2*cnL^2*eps*kN*km*respMaint - 8*E*km^2*cnE^2*cnR^2*cnL^2*eps^2*kN*km*respMaint + 4*E*km*cnE^2*cnR^2*cnL^2*eps^2*respMaint^2 + decPotR^2*km^2*cnB^2*cnE^2*cnL^2 - 2*decPotR^2*km^2*cnB*cnE^2*cnR*cnL^2*eps + decPotR^2*km^2*cnE^2*cnR^2*cnL^2*eps^2 - 2*decPotR*decPotL*km^2*cnB^2*cnE^2*cnR*cnL + 2*decPotR*decPotL*km^2*cnB*cnE^2*cnR^2*cnL*eps + 2*decPotR*decPotL*km^2*cnB*cnE^2*cnR*cnL^2*eps - 2*decPotR*decPotL*km^2*cnE^2*cnR^2*cnL^2*eps^2 + 4*decPotR*km^2*cnB*cnE^2*cnR*cnL^2*eps*respMaint - 4*decPotR*km^2*cnE^2*cnR^2*cnL^2*eps^2*respMaint + decPotL^2*km^2*cnB^2*cnE^2*cnR^2 - 2*decPotL^2*km^2*cnB*cnE^2*cnR^2*cnL*eps + decPotL^2*km^2*cnE^2*cnR^2*cnL^2*eps^2 +4*decPotL*km^2*cnB*cnE^2*cnR^2*cnL*eps*respMaint - 4*decPotL*km^2*cnE^2*cnR^2*cnL^2*eps^2*respMaint + 4*km^2*cnE^2*cnR^2*cnL^2*eps^2*respMaint^2)*abs(E))/(2*E^3*cnB*cnR*cnL*kN*kNB - 2*E^3*cnE*cnR*cnL*eps*kN*km +2*E^2*decPotR*cnB*cnE*cnL - 2*E^2*decPotR*cnE*cnR*cnL*eps + 2*E^2*decPotL*cnB*cnE*cnR - 2*E^2*decPotL*cnE*cnR*cnL*eps + 2*E^2*cnE*cnR*cnL*eps*respMaint)
    #)
    if( alpha < 0 ) alpha <- 0
    if( alpha > 1 ) alpha <- 1
    alpha
}


calcMatchAlphaSeam2 <- function(
        ### calculate optimal enzyme allocation for given optimal biomass ratio and enzyme levels
        E, decPotR, decPotL, rMaint, parms
        , cnOpt = parms$cnB, cnR=parms$cnIR, cnL=parms$cnIL
        , imm = 0   ##<< immobilization flux
){
    ##details<< Differs from calcMatchAlphaSeam by accounting for immobilization flux \code{imm}
    # see res[0] on solve eq3
    kmR <- parms$kmR
    kmL <- parms$kmL
    eps <- parms$eps
    if( parms$kmL != parms$kmR ) stop("calcMatchAlphaSeam2: only valid for parameters kmL==kmR ")
    km <- parms$kmL
    alpha <-
            # with kmL == kmR
            -(-E^2*cnL*cnOpt*cnR*imm - E^2*cnL*cnOpt*decPotR + E^2*cnL*cnR*decPotL*eps +E^2*cnL*cnR*decPotR*eps - E^2*cnL*cnR*eps*rMaint - E^2*cnOpt*cnR*decPotL - E*cnL*cnOpt*decPotR*kmR - E*cnL*cnR*decPotL*eps*kmR + E*cnL*cnR*decPotR*eps*kmR +E*cnOpt*cnR*decPotL*kmR + sqrt(E^2*cnL^2*cnOpt^2*cnR^2*imm^2 + 2*E^2*cnL^2*cnOpt^2*cnR*decPotR*imm + E^2*cnL^2*cnOpt^2*decPotR^2 - 2*E^2*cnL^2*cnOpt*cnR^2*decPotL*eps*imm - 2*E^2*cnL^2*cnOpt*cnR^2*decPotR*eps*imm + 2*E^2*cnL^2*cnOpt*cnR^2*eps*imm*rMaint - 2*E^2*cnL^2*cnOpt*cnR*decPotL*decPotR*eps - 2*E^2*cnL^2*cnOpt*cnR*decPotR^2*eps + 2*E^2*cnL^2*cnOpt*cnR*decPotR*eps*rMaint + E^2*cnL^2*cnR^2*decPotL^2*eps^2 + 2*E^2*cnL^2*cnR^2*decPotL*decPotR*eps^2 - 2*E^2*cnL^2*cnR^2*decPotL*eps^2*rMaint + E^2*cnL^2*cnR^2*decPotR^2*eps^2 - 2*E^2*cnL^2*cnR^2*decPotR*eps^2*rMaint + E^2*cnL^2*cnR^2*eps^2*rMaint^2 + 2*E^2*cnL*cnOpt^2*cnR^2*decPotL*imm + 2*E^2*cnL*cnOpt^2*cnR*decPotL*decPotR - 2*E^2*cnL*cnOpt*cnR^2*decPotL^2*eps - 2*E^2*cnL*cnOpt*cnR^2*decPotL*decPotR*eps + 2*E^2*cnL*cnOpt*cnR^2*decPotL*eps*rMaint + E^2*cnOpt^2*cnR^2*decPotL^2 + 4*E*cnL^2*cnOpt^2*cnR^2*imm^2*kmR + 6*E*cnL^2*cnOpt^2*cnR*decPotR*imm*kmR + 2*E*cnL^2*cnOpt^2*decPotR^2*kmR - 6*E*cnL^2*cnOpt*cnR^2*decPotL*eps*imm*kmR - 6*E*cnL^2*cnOpt*cnR^2*decPotR*eps*imm*kmR + 8*E*cnL^2*cnOpt*cnR^2*eps*imm*kmR*rMaint - 4*E*cnL^2*cnOpt*cnR*decPotL*decPotR*eps*kmR - 4*E*cnL^2*cnOpt*cnR*decPotR^2*eps*kmR + 6*E*cnL^2*cnOpt*cnR*decPotR*eps*kmR*rMaint + 2*E*cnL^2*cnR^2*decPotL^2*eps^2*kmR + 4*E*cnL^2*cnR^2*decPotL*decPotR*eps^2*kmR - 6*E*cnL^2*cnR^2*decPotL*eps^2*kmR*rMaint + 2*E*cnL^2*cnR^2*decPotR^2*eps^2*kmR - 6*E*cnL^2*cnR^2*decPotR*eps^2*kmR*rMaint + 4*E*cnL^2*cnR^2*eps^2*kmR*rMaint^2 + 6*E*cnL*cnOpt^2*cnR^2*decPotL*imm*kmR + 4*E*cnL*cnOpt^2*cnR*decPotL*decPotR*kmR - 4*E*cnL*cnOpt*cnR^2*decPotL^2*eps*kmR - 4*E*cnL*cnOpt*cnR^2*decPotL*decPotR*eps*kmR + 6*E*cnL*cnOpt*cnR^2*decPotL*eps*kmR*rMaint + 2*E*cnOpt^2*cnR^2*decPotL^2*kmR + 4*cnL^2*cnOpt^2*cnR^2*imm^2*kmR^2 + 4*cnL^2*cnOpt^2*cnR*decPotR*imm*kmR^2 + cnL^2*cnOpt^2*decPotR^2*kmR^2 - 4*cnL^2*cnOpt*cnR^2*decPotL*eps*imm*kmR^2 - 4*cnL^2*cnOpt*cnR^2*decPotR*eps*imm*kmR^2 + 8*cnL^2*cnOpt*cnR^2*eps*imm*kmR^2*rMaint+ 2*cnL^2*cnOpt*cnR*decPotL*decPotR*eps*kmR^2 - 2*cnL^2*cnOpt*cnR*decPotR^2*eps*kmR^2 + 4*cnL^2*cnOpt*cnR*decPotR*eps*kmR^2*rMaint + cnL^2*cnR^2*decPotL^2*eps^2*kmR^2 - 2*cnL^2*cnR^2*decPotL*decPotR*eps^2*kmR^2 - 4*cnL^2*cnR^2*decPotL*eps^2*kmR^2*rMaint + cnL^2*cnR^2*decPotR^2*eps^2*kmR^2 - 4*cnL^2*cnR^2*decPotR*eps^2*kmR^2*rMaint + 4*cnL^2*cnR^2*eps^2*kmR^2*rMaint^2 + 4*cnL*cnOpt^2*cnR^2*decPotL*imm*kmR^2 - 2*cnL*cnOpt^2*cnR*decPotL*decPotR*kmR^2 - 2*cnL*cnOpt*cnR^2*decPotL^2*eps*kmR^2 + 2*cnL*cnOpt*cnR^2*decPotL*decPotR*eps*kmR^2 + 4*cnL*cnOpt*cnR^2*decPotL*eps*kmR^2*rMaint + cnOpt^2*cnR^2*decPotL^2*kmR^2)*abs(E))/(2*E^2*cnL*cnOpt*cnR*imm + 2*E^2*cnL*cnOpt*decPotR - 2*E^2*cnL*cnR*decPotL*eps - 2*E^2*cnL*cnR*decPotR*eps + 2*E^2*cnL*cnR*eps*rMaint + 2*E^2*cnOpt*cnR*decPotL)
            # allowed kmL != kmR
            #-(-E^2*cnL*cnOpt*cnR*imm - E^2*cnL*cnOpt*decPotR + E^2*cnL*cnR*decPotL*eps +E^2*cnL*cnR*decPotR*eps - E^2*cnL*cnR*eps*rMaint - E^2*cnOpt*cnR*decPotL - E*cnL*cnOpt*cnR*imm*kmL + E*cnL*cnOpt*cnR*imm*kmR - E*cnL*cnOpt*decPotR*kmL - E*cnL*cnR*decPotL*eps*kmR + E*cnL*cnR*decPotR*eps*kmL - E*cnL*cnR*eps*kmL*rMaint + E*cnL*cnR*eps*kmR*rMaint + E*cnOpt*cnR*decPotL*kmR + sqrt(E^2*cnL^2*cnOpt^2*cnR^2*imm^2 + 2*E^2*cnL^2*cnOpt^2*cnR*decPotR*imm + E^2*cnL^2*cnOpt^2*decPotR^2 - 2*E^2*cnL^2*cnOpt*cnR^2*decPotL*eps*imm - 2*E^2*cnL^2*cnOpt*cnR^2*decPotR*eps*imm + 2*E^2*cnL^2*cnOpt*cnR^2*eps*imm*rMaint - 2*E^2*cnL^2*cnOpt*cnR*decPotL*decPotR*eps - 2*E^2*cnL^2*cnOpt*cnR*decPotR^2*eps + 2*E^2*cnL^2*cnOpt*cnR*decPotR*eps*rMaint + E^2*cnL^2*cnR^2*decPotL^2*eps^2 + 2*E^2*cnL^2*cnR^2*decPotL*decPotR*eps^2 - 2*E^2*cnL^2*cnR^2*decPotL*eps^2*rMaint + E^2*cnL^2*cnR^2*decPotR^2*eps^2 - 2*E^2*cnL^2*cnR^2*decPotR*eps^2*rMaint + E^2*cnL^2*cnR^2*eps^2*rMaint^2 + 2*E^2*cnL*cnOpt^2*cnR^2*decPotL*imm + 2*E^2*cnL*cnOpt^2*cnR*decPotL*decPotR - 2*E^2*cnL*cnOpt*cnR^2*decPotL^2*eps - 2*E^2*cnL*cnOpt*cnR^2*decPotL*decPotR*eps + 2*E^2*cnL*cnOpt*cnR^2*decPotL*eps*rMaint + E^2*cnOpt^2*cnR^2*decPotL^2 + 2*E*cnL^2*cnOpt^2*cnR^2*imm^2*kmL + 2*E*cnL^2*cnOpt^2*cnR^2*imm^2*kmR + 4*E*cnL^2*cnOpt^2*cnR*decPotR*imm*kmL + 2*E*cnL^2*cnOpt^2*cnR*decPotR*imm*kmR + 2*E*cnL^2*cnOpt^2*decPotR^2*kmL - 2*E*cnL^2*cnOpt*cnR^2*decPotL*eps*imm*kmL - 4*E*cnL^2*cnOpt*cnR^2*decPotL*eps*imm*kmR - 4*E*cnL^2*cnOpt*cnR^2*decPotR*eps*imm*kmL - 2*E*cnL^2*cnOpt*cnR^2*decPotR*eps*imm*kmR + 4*E*cnL^2*cnOpt*cnR^2*eps*imm*kmL*rMaint + 4*E*cnL^2*cnOpt*cnR^2*eps*imm*kmR*rMaint - 2*E*cnL^2*cnOpt*cnR*decPotL*decPotR*eps*kmL - 2*E*cnL^2*cnOpt*cnR*decPotL*decPotR*eps*kmR - 4*E*cnL^2*cnOpt*cnR*decPotR^2*eps*kmL + 4*E*cnL^2*cnOpt*cnR*decPotR*eps*kmL*rMaint + 2*E*cnL^2*cnOpt*cnR*decPotR*eps*kmR*rMaint + 2*E*cnL^2*cnR^2*decPotL^2*eps^2*kmR + 2*E*cnL^2*cnR^2*decPotL*decPotR*eps^2*kmL + 2*E*cnL^2*cnR^2*decPotL*decPotR*eps^2*kmR - 2*E*cnL^2*cnR^2*decPotL*eps^2*kmL*rMaint - 4*E*cnL^2*cnR^2*decPotL*eps^2*kmR*rMaint + 2*E*cnL^2*cnR^2*decPotR^2*eps^2*kmL - 4*E*cnL^2*cnR^2*decPotR*eps^2*kmL*rMaint - 2*E*cnL^2*cnR^2*decPotR*eps^2*kmR*rMaint + 2*E*cnL^2*cnR^2*eps^2*kmL*rMaint^2 + 2*E*cnL^2*cnR^2*eps^2*kmR*rMaint^2 + 2*E*cnL*cnOpt^2*cnR^2*decPotL*imm*kmL + 4*E*cnL*cnOpt^2*cnR^2*decPotL*imm*kmR + 2*E*cnL*cnOpt^2*cnR*decPotL*decPotR*kmL + 2*E*cnL*cnOpt^2*cnR*decPotL*decPotR*kmR - 4*E*cnL*cnOpt*cnR^2*decPotL^2*eps*kmR - 2*E*cnL*cnOpt*cnR^2*decPotL*decPotR*eps*kmL - 2*E*cnL*cnOpt*cnR^2*decPotL*decPotR*eps*kmR + 2*E*cnL*cnOpt*cnR^2*decPotL*eps*kmL*rMaint + 4*E*cnL*cnOpt*cnR^2*decPotL*eps*kmR*rMaint + 2*E*cnOpt^2*cnR^2*decPotL^2*kmR + cnL^2*cnOpt^2*cnR^2*imm^2*kmL^2 + 2*cnL^2*cnOpt^2*cnR^2*imm^2*kmL*kmR + cnL^2*cnOpt^2*cnR^2*imm^2*kmR^2 + 2*cnL^2*cnOpt^2*cnR*decPotR*imm*kmL^2 + 2*cnL^2*cnOpt^2*cnR*decPotR*imm*kmL*kmR + cnL^2*cnOpt^2*decPotR^2*kmL^2 - 2*cnL^2*cnOpt*cnR^2*decPotL*eps*imm*kmL*kmR - 2*cnL^2*cnOpt*cnR^2*decPotL*eps*imm*kmR^2 - 2*cnL^2*cnOpt*cnR^2*decPotR*eps*imm*kmL^2 - 2*cnL^2*cnOpt*cnR^2*decPotR*eps*imm*kmL*kmR + 2*cnL^2*cnOpt*cnR^2*eps*imm*kmL^2*rMaint + 4*cnL^2*cnOpt*cnR^2*eps*imm*kmL*kmR*rMaint + 2*cnL^2*cnOpt*cnR^2*eps*imm*kmR^2*rMaint + 2*cnL^2*cnOpt*cnR*decPotL*decPotR*eps*kmL*kmR - 2*cnL^2*cnOpt*cnR*decPotR^2*eps*kmL^2 + 2*cnL^2*cnOpt*cnR*decPotR*eps*kmL^2*rMaint + 2*cnL^2*cnOpt*cnR*decPotR*eps*kmL*kmR*rMaint + cnL^2*cnR^2*decPotL^2*eps^2*kmR^2 - 2*cnL^2*cnR^2*decPotL*decPotR*eps^2*kmL*kmR - 2*cnL^2*cnR^2*decPotL*eps^2*kmL*kmR*rMaint - 2*cnL^2*cnR^2*decPotL*eps^2*kmR^2*rMaint + cnL^2*cnR^2*decPotR^2*eps^2*kmL^2 - 2*cnL^2*cnR^2*decPotR*eps^2*kmL^2*rMaint - 2*cnL^2*cnR^2*decPotR*eps^2*kmL*kmR*rMaint + cnL^2*cnR^2*eps^2*kmL^2*rMaint^2 + 2*cnL^2*cnR^2*eps^2*kmL*kmR*rMaint^2 + cnL^2*cnR^2*eps^2*kmR^2*rMaint^2 + 2*cnL*cnOpt^2*cnR^2*decPotL*imm*kmL*kmR + 2*cnL*cnOpt^2*cnR^2*decPotL*imm*kmR^2 - 2*cnL*cnOpt^2*cnR*decPotL*decPotR*kmL*kmR - 2*cnL*cnOpt*cnR^2*decPotL^2*eps*kmR^2 + 2*cnL*cnOpt*cnR^2*decPotL*decPotR*eps*kmL*kmR + 2*cnL*cnOpt*cnR^2*decPotL*eps*kmL*kmR*rMaint + 2*cnL*cnOpt*cnR^2*decPotL*eps*kmR^2*rMaint + cnOpt^2*cnR^2*decPotL^2*kmR^2)*abs(E))/(2*E^2*cnL*cnOpt*cnR*imm + 2*E^2*cnL*cnOpt*decPotR - 2*E^2*cnL*cnR*decPotL*eps - 2*E^2*cnL*cnR*decPotR*eps + 2*E^2*cnL*cnR*eps*rMaint + 2*E^2*cnOpt*cnR*decPotL)    
    if( alpha < 0 ) alpha <- 0
    if( alpha > 1 ) alpha <- 1
    alpha
}
attr(calcMatchAlphaSeam2, "ex") <- function(){
    if( FALSE ){
        # parms0 from test_modSeam2
        E=16; decPotR=1000; decPotL=1000; respMaint=0.4; p<-parms<-parms0; cnOpt <- p$cnB; cnR=7; cnL=70
        imm = 20
        alpha <- alpha1 <- calcMatchAlphaSeam( E=E, decPotR=decPotR, decPotL=decPotL, respMaint=respMaint, parms=p, cnOpt=cnOpt, cnR=cnR, cnL=cnL)
        alpha <- alpha2 <- calcMatchAlphaSeam2( E=E, decPotR=decPotR, decPotL=decPotL, rMaint=respMaint, parms=p, cnOpt=cnOpt, cnR=cnR, cnL=cnL)
        alpha <- alpha2i <- calcMatchAlphaSeam2( E=E, decPotR=decPotR, decPotL=decPotL, rMaint=respMaint, parms=p, cnOpt=cnOpt, cnR=cnR, cnL=cnL, imm=imm)
        decR <- decPotR*alpha*E/(p$km + alpha*E)
        decL <- decPotL*(1-alpha)*E/(p$km + (1-alpha)*E)
        synC <- p$eps*(decR + decL - respMaint)
        synN <- decR/cnR + decL/cnL + imm
        c(cnOpt, synC/synN)
    }
}



