calcMatchAlpha <- function(
        ### calculate optimal enzyme allocation for given optimal biomass ratio and enzyme levels
        E, decPotS1, decPotS2, respMaint, parms
        , cnOpt = parms$cnB, cnS1=parms$cnIS1, cnS2=parms$cnIS2
){
    alpha <- -(-E^2*decPotS1*cnOpt*cnS2 + E^2*decPotS1*cnS1*cnS2*parms$eps - E^2*decPotS2*cnOpt*cnS1 + E^2*decPotS2*cnS1*cnS2*parms$eps - E^2*cnS1*cnS2*parms$eps*respMaint - E*decPotS1*parms$km*cnOpt*cnS2 + E*decPotS1*parms$km*cnS1*cnS2*parms$eps + E*decPotS2*parms$km*cnOpt*cnS1 - E*decPotS2*parms$km*cnS1*cnS2*parms$eps + sqrt(E^2*decPotS1^2*cnOpt^2*cnS2^2 - 2*E^2*decPotS1^2*cnOpt*cnS1*cnS2^2*parms$eps + E^2*decPotS1^2*cnS1^2*cnS2^2*parms$eps^2 + 2*E^2*decPotS1*decPotS2*cnOpt^2*cnS1*cnS2 - 2*E^2*decPotS1*decPotS2*cnOpt*cnS1^2*cnS2*parms$eps - 2*E^2*decPotS1*decPotS2*cnOpt*cnS1*cnS2^2*parms$eps + 2*E^2*decPotS1*decPotS2*cnS1^2*cnS2^2*parms$eps^2 + 2*E^2*decPotS1*cnOpt*cnS1*cnS2^2*parms$eps*respMaint - 2*E^2*decPotS1*cnS1^2*cnS2^2*parms$eps^2*respMaint + E^2*decPotS2^2*cnOpt^2*cnS1^2 - 2*E^2*decPotS2^2*cnOpt*cnS1^2*cnS2*parms$eps + E^2*decPotS2^2*cnS1^2*cnS2^2*parms$eps^2 + 2*E^2*decPotS2*cnOpt*cnS1^2*cnS2*parms$eps*respMaint - 2*E^2*decPotS2*cnS1^2*cnS2^2*parms$eps^2*respMaint + E^2*cnS1^2*cnS2^2*parms$eps^2*respMaint^2 + 2*E*decPotS1^2*parms$km*cnOpt^2*cnS2^2 - 4*E*decPotS1^2*parms$km*cnOpt*cnS1*cnS2^2*parms$eps + 2*E*decPotS1^2*parms$km*cnS1^2*cnS2^2*parms$eps^2 + 4*E*decPotS1*decPotS2*parms$km*cnOpt^2*cnS1*cnS2 - 4*E*decPotS1*decPotS2*parms$km*cnOpt*cnS1^2*cnS2*parms$eps - 4*E*decPotS1*decPotS2*parms$km*cnOpt*cnS1*cnS2^2*parms$eps + 4*E*decPotS1*decPotS2*parms$km*cnS1^2*cnS2^2*parms$eps^2 + 6*E*decPotS1*parms$km*cnOpt*cnS1*cnS2^2*parms$eps*respMaint - 6*E*decPotS1*parms$km*cnS1^2*cnS2^2*parms$eps^2*respMaint + 2*E*decPotS2^2*parms$km*cnOpt^2*cnS1^2 - 4*E*decPotS2^2*parms$km*cnOpt*cnS1^2*cnS2*parms$eps + 2*E*decPotS2^2*parms$km*cnS1^2*cnS2^2*parms$eps^2 + 6*E*decPotS2*parms$km*cnOpt*cnS1^2*cnS2*parms$eps*respMaint - 6*E*decPotS2*parms$km*cnS1^2*cnS2^2*parms$eps^2*respMaint + 4*E*parms$km*cnS1^2*cnS2^2*parms$eps^2*respMaint^2 + decPotS1^2*parms$km^2*cnOpt^2*cnS2^2 -2*decPotS1^2*parms$km^2*cnOpt*cnS1*cnS2^2*parms$eps + decPotS1^2*parms$km^2*cnS1^2*cnS2^2*parms$eps^2 - 2*decPotS1*decPotS2*parms$km^2*cnOpt^2*cnS1*cnS2 + 2*decPotS1*decPotS2*parms$km^2*cnOpt*cnS1^2*cnS2*parms$eps + 2*decPotS1*decPotS2*parms$km^2*cnOpt*cnS1*cnS2^2*parms$eps - 2*decPotS1*decPotS2*parms$km^2*cnS1^2*cnS2^2*parms$eps^2 + 4*decPotS1*parms$km^2*cnOpt*cnS1*cnS2^2*parms$eps*respMaint - 4*decPotS1*parms$km^2*cnS1^2*cnS2^2*parms$eps^2*respMaint + decPotS2^2*parms$km^2*cnOpt^2*cnS1^2- 2*decPotS2^2*parms$km^2*cnOpt*cnS1^2*cnS2*parms$eps + decPotS2^2*parms$km^2*cnS1^2*cnS2^2*parms$eps^2 + 4*decPotS2*parms$km^2*cnOpt*cnS1^2*cnS2*parms$eps*respMaint - 4*decPotS2*parms$km^2*cnS1^2*cnS2^2*parms$eps^2*respMaint + 4*parms$km^2*cnS1^2*cnS2^2*parms$eps^2*respMaint^2)*abs(E))/(2*E^2*decPotS1*cnOpt*cnS2 - 2*E^2*decPotS1*cnS1*cnS2*parms$eps + 2*E^2*decPotS2*cnOpt*cnS1 - 2*E^2*decPotS2*cnS1*cnS2*parms$eps + 2*E^2*cnS1*cnS2*parms$eps*respMaint)
    if( alpha < 0 ) alpha <- 0
    if( alpha > 1 ) alpha <- 1
    alpha
}
attr(calcMatchAlpha, "ex") <- function(){
    E=16; decPotS1=1000; decPotS2=1000; respMaint=0.4; p<-parms<-parms0; cnOpt <- p$cnB; cnS1=p$cnIS1; cnS2=p$cnIS2
    alpha <- alpha0 <- calcMatchAlpha( E=E, decPotS1=decPotS1, decPotS2=decPotS2, respMaint=respMaint, parms=p, cnOpt=cnOpt, cnS1=cnS1, cnS2=cnS2)
    dec1 <- decPotS1*alpha*E/(p$km + alpha*E)
    dec2 <- decPotS2*(1-alpha)*E/(p$km + (1-alpha)*E)
    synC <- p$eps*(dec1 + dec2 - respMaint)
    synN <- dec1/cnS1 + dec2/cnS2
    synC/synN
    
    (alpha <- alphaEnz <- calcMatchAlphaEnz( E=E, decPotS1=decPotS1, decPotS2=decPotS2, respMaint=respMaint, parms=p, cnOpt=cnOpt, cnS1=cnS1, cnS2=cnS2))
    #alpha <- 0
    dec1 <- decPotS1*alpha*E/(p$km + alpha*E)
    dec2 <- decPotS2*(1-alpha)*E/(p$km + (1-alpha)*E)
    decE <- p$kNB * p$kN * E
    decE/(dec1+dec2+decE)
    synC <- p$eps*(dec1 + dec2 + decE - respMaint)
    synN <- dec1/cnS1 + dec2/cnS2 + decE/p$cnE
    synC/synN
    
}


calcMatchAlphaEnz <- function(
        ### calculate optimal enzyme allocation for given optimal biomass ratio and enzyme levels by taking into account turnover of enzymes 
        E, decPotS1, decPotS2, respMaint, parms, cnOpt = parms$cnB, cnS1=parms$cnIS1, cnS2=parms$cnIS2
){
    ##details<< 
    ## Does not work so far. Do not understand why - numerical error? using the one without enzyme trvr
    alpha <- -(-E^3*cnOpt*cnS1*cnS2*parms$kN*parms$kNB + E^3*cnS1*cnS2*parms$cnE*parms$eps*parms$kN*parms$kNB - E^2*cnOpt*cnS1*decPotS2*parms$cnE - E^2*cnOpt*cnS2*decPotS1*parms$cnE + E^2*cnS1*cnS2*decPotS1*parms$cnE*parms$eps + E^2*cnS1*cnS2*decPotS2*parms$cnE*parms$eps - E^2*cnS1*cnS2*parms$cnE*parms$eps*respMaint + E*cnOpt*cnS1*decPotS2*parms$cnE*parms$km - E*cnOpt*cnS2*decPotS1*parms$cnE*parms$km +E*cnS1*cnS2*decPotS1*parms$cnE*parms$eps*parms$km - E*cnS1*cnS2*decPotS2*parms$cnE*parms$eps*parms$km + sqrt(E^4*cnOpt^2*cnS1^2*cnS2^2*parms$kN^2*parms$kNB^2 - 2*E^4*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2+ E^4*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2 + 4*E**3*cnOpt^2*cnS1^2*cnS2^2*parms$kN^2*parms$kNB^2*parms$km + 2*E^3*cnOpt^2*cnS1^2*cnS2*decPotS2*parms$cnE*parms$kN*parms$kNB + 2*E^3*cnOpt^2*cnS1*cnS2^2*decPotS1*parms$cnE*parms$kN*parms$kNB - 2*E^3*cnOpt*cnS1^2*cnS2^2*decPotS1*parms$cnE*parms$eps*parms$kN*parms$kNB - 2*E^3*cnOpt*cnS1^2*cnS2^2*decPotS2*parms$cnE*parms$eps*parms$kN*parms$kNB - 8*E^3*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2*parms$km + 2*E^3*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN*parms$kNB*respMaint - 2*E^3*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*parms$kN*parms$kNB - 2*E^3*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$kN*parms$kNB + 2*E^3*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB + 2*E^3*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB + 4*E^3*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2*parms$km - 2*E^3*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*respMaint + 4*E^2*cnOpt^2*cnS1^2*cnS2^2*parms$kN^2*parms$kNB^2*parms$km^2 + 6*E^2*cnOpt^2*cnS1^2*cnS2*decPotS2*parms$cnE*parms$kN*parms$kNB*parms$km + E^2*cnOpt^2*cnS1^2*decPotS2^2*parms$cnE^2 + 6*E^2*cnOpt^2*cnS1*cnS2^2*decPotS1*parms$cnE*parms$kN*parms$kNB*parms$km+ 2*E^2*cnOpt^2*cnS1*cnS2*decPotS1*decPotS2*parms$cnE^2 + E^2*cnOpt^2*cnS2**2*decPotS1^2*parms$cnE^2 - 6*E^2*cnOpt*cnS1^2*cnS2^2*decPotS1*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km - 6*E^2*cnOpt*cnS1^2*cnS2^2*decPotS2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km - 8*E^2*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2*parms$km^2 + 8*E^2*cnOpt*cnS1^2*cnS2**2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km*respMaint - 2*E^2*cnOpt*cnS1^2*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$eps - 2*E^2*cnOpt*cnS1^2*cnS2*decPotS2^2*parms$cnE^2*parms$eps - 6*E^2*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE**2*parms$eps*parms$kN*parms$kNB*parms$km + 2*E^2*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*respMaint - 2*E^2*cnOpt*cnS1*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps - 2*E^2*cnOpt*cnS1*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps - 6*E^2*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km + 2*E^2*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*respMaint + E^2*cnS1^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps^2 + 2*E^2*cnS1^2*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps^2 + 6*E^2*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km - 2*E^2*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*respMaint + E^2*cnS1^2*cnS2^2*decPotS2^2*parms$cnE^2*parms$eps^2 + 6*E^2*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km - 2*E^2*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*respMaint + 4*E^2*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2*parms$km^2 - 8*E^2*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km*respMaint + E^2*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*respMaint^2 + 4*E*cnOpt^2*cnS1^2*cnS2*decPotS2*parms$cnE*parms$kN*parms$kNB*parms$km^2 + 2*E*cnOpt^2*cnS1^2*decPotS2^2*parms$cnE^2*parms$km + 4*E*cnOpt^2*cnS1*cnS2^2*decPotS1*parms$cnE*parms$kN*parms$kNB*parms$km^2+ 4*E*cnOpt^2*cnS1*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$km + 2*E*cnOpt^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$km - 4*E*cnOpt*cnS1^2*cnS2^2*decPotS1*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2 - 4*E*cnOpt*cnS1^2*cnS2^2*decPotS2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2 + 8*E*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2*respMaint - 4*E*cnOpt*cnS1^2*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnS1^2*cnS2*decPotS2^2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km^2 + 6*E*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*parms$km*respMaint - 4*E*cnOpt*cnS1*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnS1*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km^2 + 6*E*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$km*respMaint + 2*E*cnS1^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnS1^2*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2 - 6*E*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$km*respMaint + 2*E*cnS1^2*cnS2^2*decPotS2^2*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2 - 6*E*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*parms$km*respMaint - 8*E*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2*respMaint + 4*E*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$km*respMaint^2 + cnOpt^2*cnS1^2*decPotS2^2*parms$cnE^2*parms$km^2 - 2*cnOpt^2*cnS1*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$km^2 + cnOpt^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$km^2 + 2*cnOpt*cnS1^2*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$eps*parms$km^2 - 2*cnOpt*cnS1^2*cnS2*decPotS2^2*parms$cnE^2*parms$eps*parms$km^2 + 4*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*parms$km^2*respMaint - 2*cnOpt*cnS1*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps*parms$km^2 + 2*cnOpt*cnS1*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps*parms$km^2 + 4*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$km^2*respMaint + cnS1^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps^2*parms$km^2 - 2*cnS1^2*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps^2*parms$km^2 - 4*cnS1**2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$km^2*respMaint + cnS1^2*cnS2^2*decPotS2^2*parms$cnE^2*parms$eps^2*parms$km^2 - 4*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*parms$km^2*respMaint + 4*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$km^2*respMaint^2)*abs(E))/(2*E^3*cnOpt*cnS1*cnS2*parms$kN*parms$kNB - 2*E^3*cnS1*cnS2*parms$cnE*parms$eps*parms$kN*parms$kNB + 2*E**2*cnOpt*cnS1*decPotS2*parms$cnE + 2*E^2*cnOpt*cnS2*decPotS1*parms$cnE - 2*E^2*cnS1*cnS2*decPotS1*parms$cnE*parms$eps - 2*E^2*cnS1*cnS2*decPotS2*parms$cnE*parms$eps + 2*E^2*cnS1*cnS2*parms$cnE*parms$eps*respMaint)
    # second solution in alpha_maint.py:
    #alpha <- (E^3*cnOpt*cnS1*cnS2*parms$kN*parms$kNB - E^3*cnS1*cnS2*parms$cnE*parms$eps*parms$kN*parms$kNB + E^2*cnOpt*cnS1*decPotS2*parms$cnE + E^2*cnOpt*cnS2*decPotS1*parms$cnE - E^2*cnS1*cnS2*decPotS1*parms$cnE*parms$eps - E^2*cnS1*cnS2*decPotS2*parms$cnE*parms$eps + E^2*cnS1*cnS2*parms$cnE*parms$eps*respMaint - E*cnOpt*cnS1*decPotS2*parms$cnE*parms$km + E*cnOpt*cnS2*decPotS1*parms$cnE*parms$km - E*cnS1*cnS2*decPotS1*parms$cnE*parms$eps*parms$km + E*cnS1*cnS2*decPotS2*parms$cnE*parms$eps*parms$km + sqrt(E^4*cnOpt^2*cnS1^2*cnS2^2*parms$kN^2*parms$kNB^2 - 2*E^4*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2 +E^4*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2 + 4*E^3*cnOpt^2*cnS1^2*cnS2^2*parms$kN^2*parms$kNB^2*parms$km + 2*E^3*cnOpt^2*cnS1^2*cnS2*decPotS2*parms$cnE*parms$kN*parms$kNB + 2*E^3*cnOpt^2*cnS1*cnS2^2*decPotS1*parms$cnE*parms$kN*parms$kNB - 2*E^3*cnOpt*cnS1^2*cnS2^2*decPotS1*parms$cnE*parms$eps*parms$kN*parms$kNB - 2*E^3*cnOpt*cnS1^2*cnS2^2*decPotS2*parms$cnE*parms$eps*parms$kN*parms$kNB - 8*E^3*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2*parms$km + 2*E^3*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN*parms$kNB*respMaint - 2*E^3*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*parms$kN*parms$kNB - 2*E^3*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$kN*parms$kNB + 2*E^3*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB + 2*E^3*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB + 4*E^3*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2*parms$km - 2*E^3*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*respMaint + 4*E^2*cnOpt^2*cnS1^2*cnS2^2*parms$kN^2*parms$kNB^2*parms$km^2 + 6*E^2*cnOpt^2*cnS1^2*cnS2*decPotS2*parms$cnE*parms$kN*parms$kNB*parms$km + E^2*cnOpt^2*cnS1^2*decPotS2^2*parms$cnE^2+ 6*E^2*cnOpt^2*cnS1*cnS2^2*decPotS1*parms$cnE*parms$kN*parms$kNB*parms$km +2*E^2*cnOpt^2*cnS1*cnS2*decPotS1*decPotS2*parms$cnE^2 + E^2*cnOpt^2*cnS2^2*decPotS1^2*parms$cnE^2 - 6*E^2*cnOpt*cnS1^2*cnS2^2*decPotS1*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km - 6*E^2*cnOpt*cnS1^2*cnS2^2*decPotS2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km - 8*E^2*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN^2*parms$kNB^2*parms$km^2 + 8*E^2*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km*respMaint - 2*E^2*cnOpt*cnS1^2*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$eps - 2*E^2*cnOpt*cnS1^2*cnS2*decPotS2^2*parms$cnE^2*parms$eps - 6*E^2*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km + 2*E^2*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*respMaint - 2*E^2*cnOpt*cnS1*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps - 2*E^2*cnOpt*cnS1*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps - 6*E^2*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km + 2*E^2*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*respMaint + E^2*cnS1^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps^2 + 2*E^2*cnS1^2*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps^2 + 6*E^2*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km - 2*E^2*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*respMaint + E^2*cnS1^2*cnS2^2*decPotS2^2*parms$cnE^2*parms$eps^2 + 6*E^2*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km - 2*E^2*cnS1^2*cnS2^2*decPotS2*parms$cnE**2*parms$eps^2*respMaint + 4*E^2*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN^2*parms$kNB^2*parms$km^2 - 8*E^2*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km*respMaint + E^2*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*respMaint^2 + 4*E*cnOpt^2*cnS1^2*cnS2*decPotS2*parms$cnE*parms$kN*parms$kNB*parms$km^2 + 2*E*cnOpt^2*cnS1^2*decPotS2^2*parms$cnE^2*parms$km+ 4*E*cnOpt^2*cnS1*cnS2^2*decPotS1*parms$cnE*parms$kN*parms$kNB*parms$km^2 +4*E*cnOpt^2*cnS1*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$km + 2*E*cnOpt^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$km - 4*E*cnOpt*cnS1^2*cnS2^2*decPotS1*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2 - 4*E*cnOpt*cnS1^2*cnS2^2*decPotS2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2 + 8*E*cnOpt*cnS1^2*cnS2^2*parms$cnE*parms$eps*parms$kN*parms$kNB*parms$km^2*respMaint - 4*E*cnOpt*cnS1^2*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnS1^2*cnS2*decPotS2^2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km^2 + 6*E*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*parms$km*respMaint - 4*E*cnOpt*cnS1*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnS1*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps*parms$km - 4*E*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$kN*parms$kNB*parms$km^2 + 6*E*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$km*respMaint + 2*E*cnS1^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnS1^2*cnS2^2*decPotS1*decPotS2*parms$cnE**2*parms$eps^2*parms$km + 4*E*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2 - 6*E*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$km*respMaint + 2*E*cnS1^2*cnS2^2*decPotS2^2*parms$cnE^2*parms$eps^2*parms$km + 4*E*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2 - 6*E*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps**2*parms$km*respMaint - 8*E*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$kN*parms$kNB*parms$km^2*respMaint + 4*E*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$km*respMaint^2 + cnOpt^2*cnS1^2*decPotS2^2*parms$cnE^2*parms$km^2 - 2*cnOpt^2*cnS1*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$km^2 + cnOpt^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$km^2 + 2*cnOpt*cnS1^2*cnS2*decPotS1*decPotS2*parms$cnE^2*parms$eps*parms$km^2 - 2*cnOpt*cnS1^2*cnS2*decPotS2^2*parms$cnE**2*parms$eps*parms$km^2 + 4*cnOpt*cnS1^2*cnS2*decPotS2*parms$cnE^2*parms$eps*parms$km^2*respMaint - 2*cnOpt*cnS1*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps*parms$km^2 + 2*cnOpt*cnS1*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps*parms$km^2 + 4*cnOpt*cnS1*cnS2^2*decPotS1*parms$cnE^2*parms$eps*parms$km^2*respMaint + cnS1^2*cnS2^2*decPotS1^2*parms$cnE^2*parms$eps^2*parms$km^2 - 2*cnS1^2*cnS2^2*decPotS1*decPotS2*parms$cnE^2*parms$eps^2*parms$km^2 - 4*cnS1^2*cnS2^2*decPotS1*parms$cnE^2*parms$eps^2*parms$km^2*respMaint + cnS1^2*cnS2^2*decPotS2^2*parms$cnE^2*parms$eps^2*parms$km^2 - 4*cnS1^2*cnS2^2*decPotS2*parms$cnE^2*parms$eps^2*parms$km^2*respMaint + 4*cnS1^2*cnS2^2*parms$cnE^2*parms$eps^2*parms$km^2*respMaint^2)*abs(E))/(2*E^3*cnOpt*cnS1*cnS2*parms$kN*parms$kNB - 2*E^3*cnS1*cnS2*parms$cnE*parms$eps*parms$kN*parms$kNB + 2*E^2*cnOpt*cnS1*decPotS2*parms$cnE + 2*E^2*cnOpt*cnS2*decPotS1*parms$cnE - 2*E^2*cnS1*cnS2*decPotS1*parms$cnE*parms$eps - 2*E^2*cnS1*cnS2*decPotS2*parms$cnE*parms$eps + 2*E^2*cnS1*cnS2*parms$cnE*parms$eps*respMaint)
    #with( parms,
    #-(-E^3*cnB*cnS1*cnS2*kN*km + E^3*cnE*cnS1*cnS2*eps*kN*km - E^2*decPotS1*cnB*cnE*cnS2 + E^2*decPotS1*cnE*cnS1*cnS2*eps - E^2*decPotS2*cnB*cnE*cnS1 + E^2*decPotS2*cnE*cnS1*cnS2*eps - E^2*cnE*cnS1*cnS2*eps*respMaint - E*decPotS1*km*cnB*cnE*cnS2 + E*decPotS1*km*cnE*cnS1*cnS2*eps + E*decPotS2*km*cnB*cnE*cnS1 - E*decPotS2*km*cnE*cnS1*cnS2*eps + sqrt(E^4*cnB^2*cnS1^2*cnS2^2*kN^2*km^2 - 2*E^4*cnB*cnE*cnS1^2*cnS2^2*eps*kN^2*km^2 + E**4*cnE^2*cnS1^2*cnS2^2*eps^2*kN^2*km^2 + 2*E^3*decPotS1*cnB^2*cnE*cnS1*cnS2^2*kN*kNB - 2*E^3*decPotS1*cnB*cnE^2*cnS1*cnS2^2*eps*kN*km - 2*E^3*decPotS1*cnB*cnE*cnS1^2*cnS2^2*eps*kN*km + 2*E^3*decPotS1*cnE^2*cnS1^2*cnS2^2*eps^2*kN*km + 2*E^3*decPotS2*cnB^2*cnE*cnS1^2*cnS2*kN*km - 2*E^3*decPotS2*cnB*cnE^2*cnS1^2*cnS2*eps*kN*km - 2*E^3*decPotS2*cnB*cnE*cnS1^2*cnS2^2*eps*kN*km + 2*E^3*decPotS2*cnE^2*cnS1^2*cnS2^2*eps^2*kN*km + 4*E^3*km*cnB^2*cnS1^2*cnS2^2*kN^2*km^2 - 8*E^3*km*cnB*cnE*cnS1^2*cnS2^2*eps*kN^2*km^2 + 4*E^3*km*cnE^2*cnS1^2*cnS2^2*eps^2*kN^2*km^2 + 2*E^3*cnB*cnE*cnS1^2*cnS2^2*eps*kN*km*respMaint - 2*E^3*cnE^2*cnS1^2*cnS2^2*eps^2*kN*km*respMaint + E^2*decPotS1^2*cnB^2*cnE^2*cnS2^2 - 2*E^2*decPotS1^2*cnB*cnE^2*cnS1*cnS2^2*eps + E^2*decPotS1^2*cnE^2*cnS1^2*cnS2^2*eps^2 + 2*E^2*decPotS1*decPotS2*cnB^2*cnE^2*cnS1*cnS2 - 2*E^2*decPotS1*decPotS2*cnB*cnE^2*cnS1^2*cnS2*eps - 2*E^2*decPotS1*decPotS2*cnB*cnE^2*cnS1*cnS2^2*eps + 2*E^2*decPotS1*decPotS2*cnE^2*cnS1^2*cnS2^2*eps^2 + 6*E^2*decPotS1*km*cnB^2*cnE*cnS1*cnS2^2*kN*km - 6*E^2*decPotS1*km*cnB*cnE^2*cnS1*cnS2^2*eps*kN*km - 6*E^2*decPotS1*km*cnB*cnE*cnS1^2*cnS2^2*eps*kN*km + 6*E^2*decPotS1*km*cnE^2*cnS1^2*cnS2^2*eps^2*kN*km + 2*E^2*decPotS1*cnB*cnE^2*cnS1*cnS2^2*eps*respMaint - 2*E^2*decPotS1*cnE^2*cnS1^2*cnS2^2*eps^2*respMaint + E^2*decPotS2**2*cnB^2*cnE^2*cnS1^2 - 2*E^2*decPotS2^2*cnB*cnE^2*cnS1^2*cnS2*eps + E^2*decPotS2^2*cnE^2*cnS1^2*cnS2^2*eps^2 + 6*E^2*decPotS2*km*cnB^2*cnE*cnS1^2*cnS2*kN*km - 6*E^2*decPotS2*km*cnB*cnE^2*cnS1^2*cnS2*eps*kN*km - 6*E^2*decPotS2*km*cnB*cnE*cnS1^2*cnS2^2*eps*kN*km + 6*E^2*decPotS2*km*cnE^2*cnS1^2*cnS2^2*eps^2*kN*km + 2*E^2*decPotS2*cnB*cnE^2*cnS1^2*cnS2*eps*respMaint - 2*E^2*decPotS2*cnE^2*cnS1^2*cnS2^2*eps^2*respMaint + 4*E^2*km^2*cnB^2*cnS1^2*cnS2^2*kN^2*km^2 - 8*E^2*km^2*cnB*cnE*cnS1^2*cnS2^2*eps*kN^2*km^2 + 4*E^2*km^2*cnE^2*cnS1^2*cnS2^2*eps^2*kN^2*kNB^2 + 8*E^2*km*cnB*cnE*cnS1^2*cnS2^2*eps*kN*km*respMaint - 8*E^2*km*cnE^2*cnS1^2*cnS2^2*eps^2*kN*km*respMaint + E^2*cnE^2*cnS1^2*cnS2^2*eps^2*respMaint^2 + 2*E*decPotS1^2*km*cnB^2*cnE^2*cnS2^2 - 4*E*decPotS1^2*km*cnB*cnE^2*cnS1*cnS2^2*eps + 2*E*decPotS1^2*km*cnE^2*cnS1^2*cnS2^2*eps^2 + 4*E*decPotS1*decPotS2*km*cnB^2*cnE^2*cnS1*cnS2 - 4*E*decPotS1*decPotS2*km*cnB*cnE^2*cnS1^2*cnS2*eps - 4*E*decPotS1*decPotS2*km*cnB*cnE^2*cnS1*cnS2^2*eps + 4*E*decPotS1*decPotS2*km*cnE^2*cnS1^2*cnS2^2*eps^2 + 4*E*decPotS1*km^2*cnB^2*cnE*cnS1*cnS2^2*kN*km - 4*E*decPotS1*km^2*cnB*cnE^2*cnS1*cnS2^2*eps*kN*km - 4*E*decPotS1*km^2*cnB*cnE*cnS1^2*cnS2^2*eps*kN*km + 4*E*decPotS1*km^2*cnE^2*cnS1^2*cnS2^2*eps^2*kN*km + 6*E*decPotS1*km*cnB*cnE^2*cnS1*cnS2^2*eps*respMaint - 6*E*decPotS1*km*cnE^2*cnS1^2*cnS2^2*eps^2*respMaint + 2*E*decPotS2^2*km*cnB^2*cnE^2*cnS1^2 - 4*E*decPotS2**2*km*cnB*cnE^2*cnS1^2*cnS2*eps + 2*E*decPotS2^2*km*cnE^2*cnS1^2*cnS2^2*eps^2 + 4*E*decPotS2*km^2*cnB^2*cnE*cnS1^2*cnS2*kN*km - 4*E*decPotS2*km^2*cnB*cnE^2*cnS1^2*cnS2*eps*kN*km - 4*E*decPotS2*km^2*cnB*cnE*cnS1^2*cnS2^2*eps*kN*km + 4*E*decPotS2*km^2*cnE^2*cnS1^2*cnS2^2*eps^2*kN*km + 6*E*decPotS2*km*cnB*cnE^2*cnS1^2*cnS2*eps*respMaint -6*E*decPotS2*km*cnE^2*cnS1^2*cnS2^2*eps^2*respMaint + 8*E*km^2*cnB*cnE*cnS1^2*cnS2^2*eps*kN*km*respMaint - 8*E*km^2*cnE^2*cnS1^2*cnS2^2*eps^2*kN*km*respMaint + 4*E*km*cnE^2*cnS1^2*cnS2^2*eps^2*respMaint^2 + decPotS1^2*km^2*cnB^2*cnE^2*cnS2^2 - 2*decPotS1^2*km^2*cnB*cnE^2*cnS1*cnS2^2*eps + decPotS1^2*km^2*cnE^2*cnS1^2*cnS2^2*eps^2 - 2*decPotS1*decPotS2*km^2*cnB^2*cnE^2*cnS1*cnS2 + 2*decPotS1*decPotS2*km^2*cnB*cnE^2*cnS1^2*cnS2*eps + 2*decPotS1*decPotS2*km^2*cnB*cnE^2*cnS1*cnS2^2*eps - 2*decPotS1*decPotS2*km^2*cnE^2*cnS1^2*cnS2^2*eps^2 + 4*decPotS1*km^2*cnB*cnE^2*cnS1*cnS2^2*eps*respMaint - 4*decPotS1*km^2*cnE^2*cnS1^2*cnS2^2*eps^2*respMaint + decPotS2^2*km^2*cnB^2*cnE^2*cnS1^2 - 2*decPotS2^2*km^2*cnB*cnE^2*cnS1^2*cnS2*eps + decPotS2^2*km^2*cnE^2*cnS1^2*cnS2^2*eps^2 +4*decPotS2*km^2*cnB*cnE^2*cnS1^2*cnS2*eps*respMaint - 4*decPotS2*km^2*cnE^2*cnS1^2*cnS2^2*eps^2*respMaint + 4*km^2*cnE^2*cnS1^2*cnS2^2*eps^2*respMaint^2)*abs(E))/(2*E^3*cnB*cnS1*cnS2*kN*kNB - 2*E^3*cnE*cnS1*cnS2*eps*kN*km +2*E^2*decPotS1*cnB*cnE*cnS2 - 2*E^2*decPotS1*cnE*cnS1*cnS2*eps + 2*E^2*decPotS2*cnB*cnE*cnS1 - 2*E^2*decPotS2*cnE*cnS1*cnS2*eps + 2*E^2*cnE*cnS1*cnS2*eps*respMaint)
    #)
    if( alpha < 0 ) alpha <- 0
    if( alpha > 1 ) alpha <- 1
    alpha
}


